(()=>{"use strict";function e(){let e=document.getElementById("ModalBg");e.classList.remove("none"),e.classList.add("modalBg");let t=document.getElementById("Modal");t.removeAttribute("hidden"),t.classList.add("modal")}function t(){let e=document.getElementById("Modal");e.classList.remove("modal"),e.setAttribute("hidden","");let t=document.getElementById("ModalBg");t.classList.remove("modalBg"),t.classList.add("none")}function n(t){let n=function(e){let t={},n=document.getElementById(`category_name${e}`);return t.name=n.innerHTML,t.id=e,t}(t.target.id.match(/[0-9]+/g)[0]);!function(e){let t=document.getElementById(`category_row${e.id}`);t.classList.remove("update-failed"),t.classList.remove("update-successful")}(n),e(),document.getElementById("nameCatPut").value=n.name,document.getElementById("idCatPut").value=n.id}function o(t){let n=function(e){let t={};t.id=e;let n=document.getElementById(`transaction_description${e}`);t.description=a(n.innerHTML);let o=a(document.getElementById(`transaction_amount${e}`).innerHTML);t.amount=o.match(/[0-9]+/g)[0];let c=a(document.getElementById(`transaction_date${e}`).innerHTML).split(".");t.date=c[2]+"-"+c[1]+"-"+c[0];let d=document.getElementById(`transaction_category${e}`);return t.category=d.dataset.id,console.log(t),t}(t.target.id.match(/[0-9]+/g)[0]);c(n),e(),function(e){document.getElementById("transactionPutId").value=e.id,document.getElementById("transactionPutDescription").value=e.description,document.getElementById("transactionPutAmount").value=e.amount,document.getElementById("transactionPutDate").value=e.date,document.getElementById("transactionPutCategory").value=e.category}(n)}function a(e){let t=e.match(/[^\n +].+[^\n +]/g)[0];return console.log(t),t}function c(e){let t=document.getElementById(`transaction_row${e.id}`);t.classList.remove("update-failed"),t.classList.remove("update-successful")}!function(){let e=document.getElementsByClassName("catBtnOpenModal"),t=e.length;for(let o=0;o<t;o++)e[o].addEventListener("click",n)}(),function(){let e=document.getElementsByClassName("transactionBtnOpenModal"),t=e.length;for(let n=0;n<t;n++)e[n].addEventListener("click",o)}(),document.catSendPutRequest=function(){let e={},n=document.getElementById("nameCatPut");e.name=n.value;let o=document.getElementById("idCatPut");e.id=o.value;let a=document.getElementById("csrf_name"),c=document.getElementById("csrf_value");fetch("/categories",{method:"PUT",body:JSON.stringify({[a.name]:a.value,[c.name]:c.value,category:e}),headers:{"Content-Type":"application/json"}}).then(t=>{console.log(t),t.ok?function(e){document.getElementById(`category_row${e.id}`).classList.add("update-successful")}(e):function(e){document.getElementById(`category_row${e.id}`).classList.add("update-failed")}(e)}).catch(e=>console.log(e)),t(),function(e){document.querySelector(`#category_name${e.id}`).innerHTML=e.name}(e)},document.transactionSendPutRequest=function(){let e=function(){let e={},t=document.getElementById("transactionPutId");e.id=t.value;let n=document.getElementById("transactionPutDescription");e.description=n.value;let o=document.getElementById("transactionPutAmount");e.amount=o.value;let a=document.getElementById("transactionPutDate");e.date=a.value;let c=document.getElementById("transactionPutCategory");return e.categoryId=c.value,e}(),n=document.getElementById("csrf_name"),o=document.getElementById("csrf_value");fetch("/transactions",{method:"PUT",body:JSON.stringify({[n.name]:n.value,[o.name]:o.value,transaction:e}),headers:{"Content-Type":"application/json"}}).then(t=>{t.ok?function(e){document.getElementById(`transaction_row${e.id}`).classList.add("update-successful"),setTimeout(c,3e3,e)}(e):function(e){document.getElementById(`transaction_row${e.id}`).classList.add("update-failed"),setTimeout(c,3e3,e)}(e)}).catch(e=>console.log(e)),t(),function(e){document.querySelector(`#transaction_description${e.id}`).innerHTML=e.description,document.querySelector(`#transaction_amount${e.id}`).innerHTML=`${e.amount}$`,document.querySelector(`#transaction_date${e.id}`).innerHTML=`${new Date(e.date).toLocaleDateString("uk-Uk")}.`;let t=document.querySelector(`#transaction_category${e.id}`),n=document.getElementById(`transactionPutCategory${e.categoryId}`).innerHTML;t.innerHTML=n}(e)},document.closeModalWindow=t,document.getNewCode=function(){fetch("/getNewVerificationCode").then(e=>{console.log(e)}).catch(e=>console.log(e))}})();